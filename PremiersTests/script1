option explicit

' Param√®tres
Dim EspacementLignes, LongueurLignes
EspacementLignes    = 5
LongueurLignes      = 100

Dim LongueurS, LargeurS
LongueurS   = 100
LargeurS    = 10

Dim LineWidth
LineWidth = "2"


WGMgr.DeleteAll
InputPlaneMgr.DeleteAll


Dim SBendArc1
Set SBendArc1 = WGMgr.CreateObj ( "WGSBendArc", "SBendArc1" )
SBendArc1.SetPosition 0, EspacementLignes/2 + LargeurS, LongueurS, EspacementLignes/2
SBendArc1.SetAttr "WidthExpr", cstr(LineWidth)
SBendArc1.SetProfileName "guidecanal1"
SBendArc1.SetDefaultThicknessTaperMode True

Dim Linear1
Set Linear1 = WGMgr.CreateObj ( "WGLinear", "Linear1" )
Linear1.SetPosition LongueurS, EspacementLignes/2, LongueurS + LongueurLignes, EspacementLignes/2
Linear1.SetAttr "WidthExpr", cstr(LineWidth)
Linear1.SetProfileName "guidecanal1"
Linear1.SetDefaultThicknessTaperMode True

Dim SBendArc2
Set SBendArc2 = WGMgr.CreateObj ( "WGSBendArc", "SBendArc2" )
SBendArc2.SetPosition LongueurS + LongueurLignes, EspacementLignes/2, 2*LongueurS + LongueurLignes, EspacementLignes/2 + LargeurS
SBendArc2.SetAttr "WidthExpr", cstr(LineWidth)
SBendArc2.SetProfileName "guidecanal1"
SBendArc2.SetDefaultThicknessTaperMode True




Dim SBendArc3
Set SBendArc3 = WGMgr.CreateObj ( "WGSBendArc", "SBendArc3" )
SBendArc3.SetAttr "AngleOffset", CDbl( 0.000000 )
SBendArc3.SetPosition 0, -EspacementLignes/2 - LargeurS, LongueurS, -EspacementLignes/2
SBendArc3.SetAttr "WidthExpr", cstr(LineWidth)
SBendArc3.SetProfileName "guidecanal1"
SBendArc3.SetDefaultThicknessTaperMode True

Dim Linear2
Set Linear2 = WGMgr.CreateObj ( "WGLinear", "Linear2" )
Linear2.SetPosition LongueurS, -EspacementLignes/2, LongueurS + LongueurLignes, -EspacementLignes/2
Linear2.SetAttr "WidthExpr", cstr(LineWidth)
Linear2.SetProfileName "guidecanal1"
Linear2.SetDefaultThicknessTaperMode True

Dim SBendArc4
Set SBendArc4 = WGMgr.CreateObj ( "WGSBendArc", "SBendArc4" )
SBendArc4.SetAttr "AngleOffset", CDbl( 0 )
SBendArc4.SetPosition LongueurS + LongueurLignes, -EspacementLignes/2, 2*LongueurS + LongueurLignes, -EspacementLignes/2 - LargeurS
SBendArc4.SetAttr "WidthExpr", cstr(LineWidth)
SBendArc4.SetProfileName "guidecanal1"
SBendArc4.SetDefaultThicknessTaperMode True



Dim InputPlane1
Set InputPlane1 = InputPlaneMgr.CreateObj ( "Gaussian", "InputPlane1" )
InputPlane1.SetZPosition 0
InputPlane1.SetReferenceIndexWaveguide2D "Unknown"
InputPlane1.SetReferenceIndexWaveguide3D "Unknown"
Dim InputFieldGauss1
Set InputFieldGauss1 = InputPlane1.CreateInputField ( "2D" , "Gaussian" , "InputFieldGauss1" )
InputFieldGauss1.SetWaveguideID "Unknown"
InputFieldGauss1.SetAmplitude "1.0"
InputFieldGauss1.SetPhase "0.0"
InputFieldGauss1.SetTiltAngleType "User"
InputFieldGauss1.SetTiltAngle "0.0"
InputFieldGauss1.SetTiltIndexType "User"
InputFieldGauss1.SetTiltIndex "0.0"
InputFieldGauss1.SetCenterX "13.5"
InputFieldGauss1.SetCenterY "0.0"
InputFieldGauss1.SetWidthTypeX "User"
InputFieldGauss1.SetWidthX "1.0"
InputFieldGauss1.SetWidthTypeY "User"
InputFieldGauss1.SetWidthY "0.0"
InputPlane1.SetEnabled TRUE



' Start Simulation
Dim lambda1, lambda2
lambda1 = 1.31
lambda2 = 1.55

ParamMgr.SetParam"lambda", CStr(lambda1)
ParamMgr.Simulate
WGMgr.Sleep(50)

ParamMgr.SetParam"lambda", CStr(lambda2)
ParamMgr.Simulate
WGMgr.Sleep(50)

